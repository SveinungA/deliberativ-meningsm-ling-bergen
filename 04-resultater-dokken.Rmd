# Dokken {#dokken}

```{r import-dp-surveys}
#last inn data fra spørreundersøkelsene
pre <- sjlabelled::read_spss(here("Data", "presurvey.sav"))
post_c <- sjlabelled::read_spss(here("Data", "post-survey-control.sav"))
post_t <- sjlabelled::read_spss(here("Data", "post-survey-treatment.sav"))
```

```{r merge-dp-surveys}
#slå sammen undersøkelsene til en fil
post_c <- post_c %>% mutate(survey = 'post_c') %>% var_labels(survey= 'Survey')
post_t <- post_t %>% mutate(survey = 'post_t') %>% var_labels(survey= 'Survey')
pre <- pre %>% mutate(survey = 'pre') %>% var_labels(survey= 'Survey')

dp_c <- full_join(post_c, pre)
dp_t <- full_join(post_t, pre)

dp_c <- dp_c %>% group_by(Q1) %>% mutate(count=n()) %>% filter(count==2)
dp_t <- dp_t %>% group_by(Q1) %>% mutate(count=n()) %>% filter(count==2)
```


## Gruppediskusjoner

Kvantitativ tekstanalyse av gruppesamtalene om Dokken.
Grupper på tematikk, plukk ut representative setninger.

## Svarfordeling for alle spørsmål om Dokken. 

Svarene baseres på undersøkelsen *deltakerne* fikk *etter* den deliberative meningsmålingen.

### Intro

Introduksjonstekst til spørsmål om Dokken:

>Først ønsker vi å stille deg noen spørsmål om Dokken. 
Dokken er et havneområde som ligger sentralt plassert i Bergen ved Puddefjorden, mellom Laksevåg og Nordnes.
Bergen kommune arbeider nå med planer for å fornye dette området, og vi ønsker å stille deg noen spørsmål om hva du tenker dette området bør brukes til.


### Cruisetrafikk ut av sentrum?
Spørsmål:

>Nå er det besluttet at havneaktivitet knyttet til gods skal flyttes fra Dokken til nytt anlegg på Ågotnes.
Selv om godshavnen flyttes er det fremdeles flere andre havneaktiviteter som kan bli værende på Dokken eller et annet sted i Bergen sentrum. Alternativet er å flytte oppgavene ut av sentrum til andre områder, og heller bruke Dokken til andre formål.
Noen mener at cruisetrafikken bør bli værende i sentrum for å legge til rette for turistnæringen. Andre mener den bør legges utenfor sentrum fordi skipene forurenser og tar opp verdifull plass sentralt i byen. Hva mener du?

```{r hist}
dp_t_post <- dp_t %>% 
  filter(survey == 'post_t')
```

```{r Q3}
dp_t_post <- dp_t_post %>% mutate(fill = case_when(Q3 %in% 1:5 ~ "Mindretall",
                                          Q3 == 6 | Q3 == 12 ~ "Ikke medregnet",
                                          Q3 %in% 7:11 ~ "Flertall"))
plot <- ggplot(dp_t_post, aes(x = factor(Q3), fill = fill)) +
  geom_bar(aes(y = (..count..) / sum(..count..))) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  scale_x_discrete(labels = c('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'Vet ikke')) +
   labs(title = "Cruisetrafikken ut av sentrum?", x = 'Svarfordeling fra 0 = Må bli værende til 10 = Må flyttes ut', y = 'Prosent', fill = '')  +
  theme_classic()
  
plot
```

Av de som uttrykte en mening enten for eller mot å flytte cruisetrafikken ut av sentrum mente `r round(sum((dp_t_post$fill=='Mindretall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent at cruisetrafikken må bli værende i sentrum, mens `r round(sum((dp_t_post$fill=='Flertall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent mener at den må flyttes ut av sentrum.
Det er også verdt å merke seg at mange av de som mener den må flyttes ut av sentrum mener dette ekstremt sterkt.

### Utenlandsferger ut av sentrum?

Spørsmålstekst:

>Noen mener også at utenlands fergetilbud (som Danskebåten) bør bli værende i sentrum for å legge til rette for turistnæringen. Andre mener den bør legges utenfor sentrum fordi skipene forurenser og tar opp verdifull plass sentralt i byen. Hva mener du?

```{r Q4}
dp_t_post <- dp_t_post %>% mutate(fill = case_when(Q4 %in% 1:5 ~ "Mindretall",
                                          Q4 == 6 | Q4 == 12 ~ "Ikke medregnet",
                                          Q4 %in% 7:11 ~ "Flertall"))
plot <- ggplot(dp_t_post, aes(x = factor(Q4), fill = fill)) +
  geom_bar(aes(y = (..count..) / sum(..count..))) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  scale_x_discrete(labels = c('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'Vet ikke')) +
   labs(title = "Utenlandsferger ut av sentrum?", x = 'Svarfordeling fra 0 = Må bli værende til 10 = Må flyttes ut', y = 'Prosent', fill = '')  +
  theme_classic()
  
plot

```
Av de som uttrykte en mening enten for eller mot å flytte utenlandsfergene ut av sentrum mente `r round(sum((dp_t_post$fill=='Mindretall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent at utenlandsfergene må bli værende i sentrum, mens `r round(sum((dp_t_post$fill=='Flertall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent mener at de må flyttes ut av sentrum.

### Utfylling i sjø

Spørsmålstekst:

>Utfylling i sjø er en mulighet som vurderes på Dokken. Noen er for dette fordi det gir mer plass til boliger, næring og parker sentralt i byen. 
Andre er mot dette fordi de ønsker å bevare sjøfronten slik den ser ut i dag og for å spare dyrelivet i sjøen. Hva mener du, bør kommunen fylle ut i sjøen når de fornyer havneområdet på Dokken?

```{r Q5}
dp_t_post <- dp_t_post %>% mutate(fill = case_when(Q5 %in% 1:5 ~ "Mindretall",
                                          Q5 == 6 | Q5 == 12 ~ "Ikke medregnet",
                                          Q5 %in% 7:11 ~ "Flertall"))
plot <- ggplot(dp_t_post, aes(x = factor(Q5), fill = fill)) +
  geom_bar(aes(y = (..count..) / sum(..count..))) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  scale_x_discrete(labels = c('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'Vet ikke')) +
   labs(title = "Utfylling i sjø?", x = 'Svarfordeling fra 0 = Motsetter seg til 10 = Støtter', y = 'Prosent', fill = '')  +
  theme_classic()
  
plot

```
Av de som uttrykte en mening enten for eller mot utfylling i sjø på Dokken er det `r round(sum((dp_t_post$fill=='Mindretall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent som motsetter seg forslaget, mens `r round(sum((dp_t_post$fill=='Flertall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent støtter det.

### Hva sjølinjen skal brukes til

Spørsmålstekst:

>Dokken har en 2500 meter lang sjølinje som i dag brukes til havneaktivitet. 
Noen mener at havneaktiviteten må prioriteres langs sjølinjen på Dokken for å kunne legge til rette for større skip og bedrifter med behov for kai.
Andre mener sjølinjen må gjøres tilgjengelig for byens innbyggere og besøkende for rekreasjon med for eksempel badeplasser og parker, eller tilrettelegging for natur- og dyreliv. 
Hva mener du?

```{r Q6}
dp_t_post <- dp_t_post %>% mutate(fill = case_when(Q6 %in% 1:5 ~ "Mindretall",
                                          Q6 == 6 | Q6 == 12 ~ "Ikke medregnet",
                                          Q6 %in% 7:11 ~ "Flertall")) 

plot <- ggplot(dp_t_post, aes(x = factor(Q6), fill = fill)) +
  geom_bar(aes(y = (..count..) / sum(..count..))) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  scale_x_discrete(labels = c('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'Vet ikke'), drop = FALSE) +
   labs(title = "Sjølinjen", x = 'Svarfordeling fra 0 = Fortsatt havneaktivitet, til 10 = Rekreasjon eller natur- og dyreliv', y = 'Prosent', fill = '')  +
  theme_classic()
  
plot

```
> Obs! Ingen observasjoner av verdi 2, som gjør søylene kommer på feil plass. Jobber med saken.

Av de som uttrykte en prioritering angående hva sjølinjen skal brukes til er det `r round(sum((dp_t_post$fill=='Mindretall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent som ønsker fortsatt havneaktivitet, mens `r round(sum((dp_t_post$fill=='Flertall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent ønsker at området skal prioriteres til rekreasjon eller natur- og dyreliv.

### Boligpolitikk

Spørsmålstekst:

>Noen mener at prisene på boliger som bygges på Dokken må styres ved at myndighetene tar en aktiv rolle i utviklingen av rimelige boliger folk flest har råd til å bo i. 
Andre mener at boliger på Dokken bør selges til ordinær markedspris. 
Hva mener du?

```{r Q7}
dp_t_post <- dp_t_post %>% mutate(fill = case_when(Q7 %in% 1:5 ~ "Mindretall",
                                          Q7 == 6 | Q7 == 12 ~ "Ikke medregnet",
                                          Q7 %in% 7:11 ~ "Flertall")) 

plot <- ggplot(dp_t_post, aes(x = factor(Q7), fill = fill)) +
  geom_bar(aes(y = (..count..) / sum(..count..))) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  scale_x_discrete(labels = c('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'Vet ikke'), drop = FALSE) +
   labs(title = "Boligpolitikk", x = 'Svarfordeling fra 0 = Sikre rimelige boliger, til 10 = Ikke blande seg inn', y = 'Prosent', fill = '')  +
  theme_classic()
  
plot

```

Av de som uttrykte en mening om hvorvidt kommunen skal sikre rimelige boliger eller om de ikke skal blande seg inn i hva boligene på Dokken skal koste, er det `r round(sum((dp_t_post$fill=='Mindretall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent som ønsker at rimelige boliger sikres, mens `r round(sum((dp_t_post$fill=='Flertall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent ønsker at kommunen ikke skal blande seg inn.

### Parker vs. idrettsanlegg

Spørsmålstekst:

>Noen mener at parker og grøntarealer bør prioriteres på Dokken framfor idrettsanlegg som for eksempel fotballbane og flerbrukshall. 
Dette fordi flere har nytte av grøntarealer enn av idrettsanlegg. 
Andre mener idrettsanlegg må prioriteres fordi det er mangel på slike tilbud sentralt i Bergen.
Hva mener du?

```{r Q8}
dp_t_post <- dp_t_post %>% mutate(fill = case_when(Q8 %in% 1:5 ~ "Flertall",
                                          Q8 == 6 | Q8 == 12 ~ "Ikke medregnet",
                                          Q8 %in% 7:11 ~ "Mindretall")) 

plot <- ggplot(dp_t_post, aes(x = factor(Q8), fill = fill)) +
  geom_bar(aes(y = (..count..) / sum(..count..))) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  scale_x_discrete(labels = c('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'Vet ikke'), drop = FALSE) +
   labs(title = "Parker vs. idrettsanlegg", x = 'Svarfordeling fra 0 = Prioritere parker, til 10 = Prioritere idrettsanlegg', y = 'Prosent', fill = '')  +
  theme_classic()
  
plot

```
> Obs! Flere verdier med manglende observasjoner, som gjør at søylene kommer på feil plass. Jobber med saken.


Av de som uttrykte en prioritering mellom parker/grøntarealer og idrettsanlegg, er det `r round(sum((dp_t_post$fill=='Mindretall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent som ønsker at parker får forrang framfor idrettsanlegg, mens `r round(sum((dp_t_post$fill=='Flertall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent ville prioritere omvendt.

### Nye gatenavn
Spørsmålstekst:

>Noen mener at alle nye gater på Dokken som skal kalles opp etter historiske personer må ha navn etter kvinner, for å bidra til å rette opp den skjeve fordelingen av eksisterende gatenavn i byen. 
Andre er imot dette, fordi personer som har gjort seg fortjent til å få en gate kalt opp etter seg ikke skal hindres på grunn av sitt kjønn.
Hva mener du?


```{r Q9}
dp_t_post <- dp_t_post %>% mutate(fill = case_when(Q9 %in% 1:5 ~ "Mindretall",
                                          Q9 == 6 | Q9 == 12 ~ "Ikke medregnet",
                                          Q9 %in% 7:11 ~ "Flertall")) 

plot <- ggplot(dp_t_post, aes(x = factor(Q9), fill = fill)) +
  geom_bar(aes(y = (..count..) / sum(..count..))) +
  scale_y_continuous(labels = scales::percent_format(accuracy = 1L)) +
  scale_x_discrete(labels = c('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', 'Vet ikke'), drop = FALSE) +
   labs(title = "Kalle opp nye gatenavn etter kvinner", x = 'Svarfordeling fra 0 = Motsetter seg, til 10 = Støtter', y = 'Prosent', fill = '')  +
  theme_classic()
  
plot

```


Av de som uttrykte en mening om hvorvidt nye gatenavn på Dokken som skal kalles opp etter historiske personer utelukkende skal ha navn etter kvinner eller ikke, mener `r round(sum((dp_t_post$fill=='Mindretall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent at de ikke skal det, og `r round(sum((dp_t_post$fill=='Flertall') / (sum(dp_t_post$fill=='Mindretall')+(sum(dp_t_post$fill=='Flertall'))))*100, 0)` prosent mener at de skal det.
Verdt å merke seg er at mange er i tvende sinn om spørsmålet (både svaralternativ 5 og "Vet ikke"-kategoriene har høyere svarandel enn i mange andre spørsmål).
Samtidig har mange av de som har gjort seg opp en mening sterke meninger om saken, i begge endene av holdningsspekteret.


## Endring i holdninger
```{r results-dokken-change}
#Gjør om "Vet ikke" til missing
dp_c <- dp_c %>% mutate(Q3 = na_if(Q3, 12),
                        Q4 = na_if(Q4, 12),
                        Q5 = na_if(Q5, 12),
                        Q6 = na_if(Q6, 12),
                        Q7 = na_if(Q7,12),
                        Q8 = na_if(Q8,12),
                        Q9 = na_if(Q9,12)
                        )
dp_t <- dp_t %>% mutate(Q3 = na_if(Q3, 12),
                        Q4 = na_if(Q4, 12),
                        Q5 = na_if(Q5, 12),
                        Q6 = na_if(Q6, 12),
                        Q7 = na_if(Q7,12),
                        Q8 = na_if(Q8,12),
                        Q9 = na_if(Q9,12)
                        )
#Beregn gjennomsnitt og standarfeil til estimatet
Q3_c <- dp_c %>% group_by(survey) %>% summarise(mean=mean(Q3, na.rm=TRUE), se=sd(Q3, na.rm = TRUE)/sqrt(length(Q3))) %>% mutate(group = 'control', question = 'Q3')
Q4_c <- dp_c %>% group_by(survey) %>% summarise(mean=mean(Q4, na.rm=TRUE), se=sd(Q4, na.rm = TRUE)/sqrt(length(Q4))) %>% mutate(group = 'control', question = 'Q4')
Q5_c <- dp_c %>% group_by(survey) %>% summarise(mean=mean(Q5, na.rm=TRUE), se=sd(Q5, na.rm = TRUE)/sqrt(length(Q5)))  %>% mutate(group = 'control', question = 'Q5')
Q6_c <- dp_c %>% group_by(survey) %>% summarise(mean=mean(Q6, na.rm=TRUE), se=sd(Q6, na.rm = TRUE)/sqrt(length(Q6))) %>% mutate(group = 'control', question = 'Q6')
Q7_c <- dp_c %>% group_by(survey) %>% summarise(mean=mean(Q7, na.rm=TRUE), se=sd(Q7, na.rm = TRUE)/sqrt(length(Q7))) %>% mutate(group = 'control', question = 'Q7')
Q8_c<- dp_c %>% group_by(survey) %>% summarise(mean=mean(Q8, na.rm=TRUE), se=sd(Q8, na.rm = TRUE)/sqrt(length(Q8))) %>% mutate(group = 'control', question = 'Q8')
Q9_c <- dp_c %>% group_by(survey) %>% summarise(mean=mean(Q9, na.rm=TRUE), se=sd(Q9, na.rm = TRUE)/sqrt(length(Q9))) %>% mutate(group = 'control', question = 'Q9')

Q3_t <- dp_t %>% group_by(survey) %>% summarise(mean=mean(Q3, na.rm=TRUE), se=sd(Q3, na.rm = TRUE)/sqrt(length(Q3))) %>% mutate(group = 'treatment', question = 'Q3')
Q4_t <- dp_t %>% group_by(survey) %>% summarise(mean=mean(Q4, na.rm=TRUE), se=sd(Q4, na.rm = TRUE)/sqrt(length(Q4))) %>% mutate(group = 'treatment', question = 'Q4')
Q5_t <- dp_t %>% group_by(survey) %>% summarise(mean=mean(Q5, na.rm=TRUE), se=sd(Q5, na.rm = TRUE)/sqrt(length(Q5))) %>% mutate(group = 'treatment', question = 'Q5')
Q6_t <- dp_t %>% group_by(survey) %>% summarise(mean=mean(Q6, na.rm=TRUE), se=sd(Q6, na.rm = TRUE)/sqrt(length(Q6))) %>% mutate(group = 'treatment', question = 'Q6')
Q7_t <- dp_t %>% group_by(survey) %>% summarise(mean=mean(Q7, na.rm=TRUE), se=sd(Q7, na.rm = TRUE)/sqrt(length(Q7))) %>% mutate(group = 'treatment', question = 'Q7')
Q8_t<- dp_t %>% group_by(survey) %>% summarise(mean=mean(Q8, na.rm=TRUE), se=sd(Q8, na.rm = TRUE)/sqrt(length(Q8))) %>% mutate(group = 'treatment', question = 'Q8')
Q9_t <- dp_t %>% group_by(survey) %>% summarise(mean=mean(Q9, na.rm=TRUE), se=sd(Q9, na.rm = TRUE)/sqrt(length(Q9))) %>% mutate(group = 'treatment', question = 'Q9')

dokken <- bind_rows(list(Q3_c, Q4_c, Q5_c, Q6_c, Q7_c, Q8_c, Q9_c, Q3_t, Q4_t, Q5_t, Q6_t, Q7_t, Q8_t, Q9_t), .id = "group") %>% 
 mutate(group = (case_when(group %in% c(1:7) ~ 'control',
                                               group %in% c(8:14) ~ 'treatment')),
                            question = (case_when(question == 'Q3' ~ 'Cruise traffic out of city center',
                                                  question == 'Q4' ~ 'International ferries out of city center',
                                                  question == 'Q5' ~ 'Expand in sea',
                                                  question == 'Q6' ~ 'Keep using sea front for port activities or repurpose for recreation',
                                                  question == 'Q7' ~ 'Regulate housing prizes',
                                                  question == 'Q8' ~ 'Prioritize general green areas over dedicated sports facilities',
                                                  question == 'Q9' ~ 'Name new streets after women only')),
                            survey = case_when(survey == 'pre'~ 'pre',
                                               survey == 'post_c' ~ 'post',
                                               survey == 'post_t' ~ 'post'
                                               )) %>%
  mutate(avg=mean) %>% 
  mutate(conf.low = avg-se) %>% 
  mutate(conf.high = avg+se) %>% 
  select(-mean) %>% 
  arrange(question) %>% 
  relocate(c(question, group, survey, avg, se))
```

```{r dokken-results-figure1, include=FALSE}
#Plot
pd <- position_dodge(1)

plot1 <- ggplot(dokken, aes(x = survey, y = avg, colour=question, group=question)) +
  geom_errorbar(aes(ymin = avg-se, ymax = avg+se), position = pd, size=1, width=0.1) +
  geom_line(position=pd) +
  geom_point(position=pd, size=3) +
  scale_y_continuous(limits = c(1, 11), breaks=seq(1:11)) +
  facet_wrap(~group)
plot1
```

```{r dokken-results-table1, include=FALSE}
dokken %>% select(question, group, survey, avg, se) %>% kableExtra::kable(., booktabs = T) %>% kable_styling(c('striped', 'hover')) %>% collapse_rows(columns = c(1:2)) %>% 
      footnote(general = 'All questions range from 1 to 11. "Do not knows" and "NA" omitted.')

write_csv(dokken, 'Data/Dokken.csv')
```
The figure below more clearly displays how the participants in the treatment group changed attitudes after having dicussed the topics.
The dotted line represents the average in the pre-survey, and the coefficients indicate the difference in attitude from the pre-survey.
A general pattern emerges where the treatment groups tend to be further away from their original pre-survey responses.
They are also significantly different changes compared to the post-survey changes in the control group.
With the caveat that these analyses are very preliminary, it does seem that having discussed the topics related to the Dokken port area clearly has influenced the participants' opinions.

```{r dokken-results-manage-2}
#Hent bearbeidet excelfil med forskjeller i gjennomsnitt for de ulike gruppene
postpre <- read_csv('Data/Dokken-postpre.csv')
postpre <- postpre %>% filter(!is.na(postpre))
```

```{r dokken-results-figure2}
#lag figur
plot2 <- ggplot(postpre, aes(x = question, y = postpre, colour=group)) +
  geom_errorbar(aes(ymin = postpre-se, ymax = postpre+se), size = 1, width = 0.1) +
  geom_point(size=3) +
  coord_flip() +
  geom_hline(aes(yintercept=0), linetype = 'dotted')

plot2

```
                      

